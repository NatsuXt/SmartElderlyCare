# å‰ç«¯é›†æˆæ™ºæ…§å…»è€ç³»ç»Ÿç¬¬ä¸‰æ¨¡å—APIæŒ‡å—

## ğŸŒ APIåŸºç¡€ä¿¡æ¯
- **æœåŠ¡å™¨åœ°å€**: http://47.96.238.102:3003
- **APIæ–‡æ¡£**: http://47.96.238.102:3003/swagger
- **å­—ç¬¦ç¼–ç **: UTF-8 (æ”¯æŒä¸­æ–‡)
- **æ•°æ®æ ¼å¼**: JSON

## ğŸ”§ ä¸­æ–‡å­—ç¬¦æ­£ç¡®å¤„ç†æ–¹æ³•

### å…³é”®è¦æ±‚
1. **Content-Type**: å¿…é¡»è®¾ç½®ä¸º `application/json; charset=utf-8`
2. **è¯·æ±‚ç¼–ç **: ç¡®ä¿è¯·æ±‚ä½“ä½¿ç”¨UTF-8ç¼–ç 
3. **JSONç¼–ç **: ä½¿ç”¨æ­£ç¡®çš„JSONåºåˆ—åŒ–è®¾ç½®

### JavaScript/Axios æ­£ç¡®ä½¿ç”¨æ–¹æ³•

```javascript
// åŸºç¡€é…ç½®
const API_BASE_URL = 'http://47.96.238.102:3003';

// åˆ›å»ºå¸¦ä¸­æ–‡å­—ç¬¦çš„æˆ¿é—´ - æ­£ç¡®æ–¹æ³•
async function createRoomWithChinese() {
    const roomData = {
        roomNumber: "è±ªåå¥—æˆ¿101",
        roomType: "è±ªåå¥—æˆ¿",
        capacity: 2,
        status: "ç©ºé—²",
        rate: 288.50,
        bedType: "åŒäººå¤§åºŠ",
        floor: 3
    };

    try {
        const response = await axios({
            method: 'POST',
            url: `${API_BASE_URL}/api/RoomManagement/rooms`,
            data: roomData,
            headers: {
                'Content-Type': 'application/json; charset=utf-8',
                'Accept': 'application/json'
            },
            // ç¡®ä¿è¯·æ±‚ä½“æ­£ç¡®ç¼–ç 
            transformRequest: [(data) => {
                return JSON.stringify(data);
            }]
        });
        
        console.log('æˆ¿é—´åˆ›å»ºæˆåŠŸ:', response.data);
        return response.data;
    } catch (error) {
        console.error('æˆ¿é—´åˆ›å»ºå¤±è´¥:', error);
        throw error;
    }
}

// åˆ›å»ºå¸¦ä¸­æ–‡å­—ç¬¦çš„è®¾å¤‡ - æ­£ç¡®æ–¹æ³•
async function createDeviceWithChinese() {
    const deviceData = {
        deviceName: "æ™ºèƒ½è¡€å‹ç›‘æµ‹ä»ª",
        deviceType: "åŒ»ç–—ç›‘æµ‹è®¾å¤‡",
        location: "äºŒæ¥¼æŠ¤å£«ç«™",
        status: "æ­£å¸¸è¿è¡Œ",
        description: "ä¸“ä¸šåŒ»ç–—çº§è¡€å‹ç›‘æµ‹è®¾å¤‡ï¼Œæ”¯æŒä¸­æ–‡æ˜¾ç¤º",
        installationDate: new Date().toISOString()
    };

    try {
        const response = await axios.post(
            `${API_BASE_URL}/api/DeviceManagement/devices`,
            deviceData,
            {
                headers: {
                    'Content-Type': 'application/json; charset=utf-8',
                    'Accept': 'application/json'
                }
            }
        );
        
        console.log('è®¾å¤‡åˆ›å»ºæˆåŠŸ:', response.data);
        return response.data;
    } catch (error) {
        console.error('è®¾å¤‡åˆ›å»ºå¤±è´¥:', error);
        throw error;
    }
}
```

### Fetch API æ­£ç¡®ä½¿ç”¨æ–¹æ³•

```javascript
// ä½¿ç”¨ Fetch API åˆ›å»ºä¸­æ–‡æ•°æ®
async function createHealthRecordWithChinese() {
    const healthData = {
        elderlyName: "å¼ ä¸‰",
        checkupType: "å¸¸è§„ä½“æ£€",
        healthStatus: "è‰¯å¥½",
        notes: "è¡€å‹æ­£å¸¸ï¼Œå¿ƒç‡ç¨³å®šï¼Œå»ºè®®å®šæœŸå¤æŸ¥",
        checkupDate: new Date().toISOString()
    };

    try {
        const response = await fetch(`${API_BASE_URL}/api/HealthMonitoring/records`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json; charset=utf-8',
                'Accept': 'application/json'
            },
            // ç¡®ä¿JSONæ­£ç¡®åºåˆ—åŒ–ä¸­æ–‡å­—ç¬¦
            body: JSON.stringify(healthData)
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        console.log('å¥åº·è®°å½•åˆ›å»ºæˆåŠŸ:', result);
        return result;
    } catch (error) {
        console.error('å¥åº·è®°å½•åˆ›å»ºå¤±è´¥:', error);
        throw error;
    }
}
```

### React/TypeScript ç¤ºä¾‹

```typescript
import axios, { AxiosResponse } from 'axios';

interface RoomCreateRequest {
    roomNumber: string;
    roomType: string;
    capacity: number;
    status: string;
    rate: number;
    bedType: string;
    floor: number;
}

interface ApiResponse<T> {
    success: boolean;
    message: string;
    data: T;
}

class SmartElderlyAPI {
    private readonly baseURL = 'http://47.96.238.102:3003';
    
    // é…ç½®axioså®ä¾‹
    private api = axios.create({
        baseURL: this.baseURL,
        timeout: 10000,
        headers: {
            'Content-Type': 'application/json; charset=utf-8',
            'Accept': 'application/json'
        }
    });

    // åˆ›å»ºæˆ¿é—´ - æ”¯æŒä¸­æ–‡å­—ç¬¦
    async createRoom(roomData: RoomCreateRequest): Promise<ApiResponse<any>> {
        try {
            const response: AxiosResponse<ApiResponse<any>> = await this.api.post(
                '/api/RoomManagement/rooms',
                roomData
            );
            return response.data;
        } catch (error) {
            console.error('åˆ›å»ºæˆ¿é—´å¤±è´¥:', error);
            throw error;
        }
    }

    // è·å–æˆ¿é—´åˆ—è¡¨
    async getRooms(search?: string): Promise<ApiResponse<any[]>> {
        try {
            const params = search ? { search } : {};
            const response: AxiosResponse<ApiResponse<any[]>> = await this.api.get(
                '/api/RoomManagement/rooms',
                { params }
            );
            return response.data;
        } catch (error) {
            console.error('è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥:', error);
            throw error;
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const api = new SmartElderlyAPI();

// åˆ›å»ºåŒ…å«ä¸­æ–‡çš„æˆ¿é—´
const createChineseRoom = async () => {
    const roomData: RoomCreateRequest = {
        roomNumber: "è´µå®¾å¥—æˆ¿888",
        roomType: "æ€»ç»Ÿå¥—æˆ¿",
        capacity: 4,
        status: "ç©ºé—²",
        rate: 888.88,
        bedType: "ç‰¹å¤§å·åºŠ",
        floor: 8
    };

    try {
        const result = await api.createRoom(roomData);
        console.log('ä¸­æ–‡æˆ¿é—´åˆ›å»ºæˆåŠŸ:', result);
    } catch (error) {
        console.error('ä¸­æ–‡æˆ¿é—´åˆ›å»ºå¤±è´¥:', error);
    }
};
```

## ğŸ” å¸¸è§APIç«¯ç‚¹åŠä½¿ç”¨æ–¹æ³•

### 1. æˆ¿é—´ç®¡ç† (/api/RoomManagement)

```javascript
// åˆ›å»ºæˆ¿é—´
POST /api/RoomManagement/rooms
{
    "roomNumber": "è±ªåå¥—æˆ¿101",
    "roomType": "è±ªåå¥—æˆ¿", 
    "capacity": 2,
    "status": "ç©ºé—²",
    "rate": 288.50,
    "bedType": "åŒäººå¤§åºŠ",
    "floor": 3
}

// è·å–æˆ¿é—´åˆ—è¡¨
GET /api/RoomManagement/rooms?search=è±ªå

// è·å–ç‰¹å®šæˆ¿é—´
GET /api/RoomManagement/rooms/{roomId}

// æ›´æ–°æˆ¿é—´
PUT /api/RoomManagement/rooms/{roomId}
{
    "roomType": "æ€»ç»Ÿå¥—æˆ¿",
    "status": "å·²å…¥ä½"
}
```

### 2. è®¾å¤‡ç®¡ç† (/api/DeviceManagement)

```javascript
// åˆ›å»ºè®¾å¤‡
POST /api/DeviceManagement/devices
{
    "deviceName": "æ™ºèƒ½è¡€å‹ç›‘æµ‹ä»ª",
    "deviceType": "åŒ»ç–—ç›‘æµ‹è®¾å¤‡",
    "location": "äºŒæ¥¼æŠ¤å£«ç«™",
    "status": "æ­£å¸¸è¿è¡Œ",
    "description": "ä¸“ä¸šåŒ»ç–—çº§è®¾å¤‡"
}

// è·å–è®¾å¤‡åˆ—è¡¨
GET /api/DeviceManagement/devices?search=è¡€å‹

// è·å–è®¾å¤‡çŠ¶æ€
GET /api/DeviceManagement/devices/{deviceId}/status
```

### 3. å¥åº·ç›‘æµ‹ (/api/HealthMonitoring)

```javascript
// åˆ›å»ºå¥åº·è®°å½•
POST /api/HealthMonitoring/records
{
    "elderlyName": "å¼ ä¸‰",
    "checkupType": "å¸¸è§„ä½“æ£€",
    "healthStatus": "è‰¯å¥½",
    "notes": "è¡€å‹æ­£å¸¸ï¼Œå¿ƒç‡ç¨³å®š"
}
```

### 4. ç”µå­å›´æ  (/api/ElectronicFence)

```javascript
// åˆ›å»ºå›´æ 
POST /api/ElectronicFence/fences
{
    "fenceName": "åŒ»é™¢å®‰å…¨åŒºåŸŸ",
    "areaDefinition": "åŒ»é™¢å¤§æ¥¼åŠå‘¨è¾¹50ç±³èŒƒå›´",
    "isActive": true,
    "status": "æ­£å¸¸è¿è¡Œ"
}
```

## ğŸš¨ ä¸­æ–‡å­—ç¬¦é—®é¢˜æ’æŸ¥

å¦‚æœåˆ›å»ºæ•°æ®ååœ¨æ•°æ®åº“ä¸­æ˜¾ç¤ºä¸ºé—®å·ï¼Œè¯·æ£€æŸ¥ï¼š

### 1. è¯·æ±‚å¤´è®¾ç½®
```javascript
headers: {
    'Content-Type': 'application/json; charset=utf-8',  // å¿…é¡»åŒ…å«charset=utf-8
    'Accept': 'application/json'
}
```

### 2. JSONåºåˆ—åŒ–
```javascript
// ç¡®ä¿ä½¿ç”¨æ ‡å‡†JSON.stringify
body: JSON.stringify(data)  // ä¸è¦ä½¿ç”¨å…¶ä»–åºåˆ—åŒ–æ–¹æ³•
```

### 3. ç½‘ç»œç¼–ç 
```javascript
// å¯¹äºç‰¹æ®Šæƒ…å†µï¼Œå¯ä»¥æ˜¾å¼ç¼–ç 
const encodedData = encodeURIComponent(JSON.stringify(data));
```

### 4. æµ‹è¯•éªŒè¯
```javascript
// åˆ›å»ºåç«‹å³è¯»å–éªŒè¯
async function testChineseCharacters() {
    // åˆ›å»º
    const createResponse = await createRoomWithChinese();
    
    // ç«‹å³è¯»å–éªŒè¯
    const roomId = createResponse.data.roomId;
    const getResponse = await axios.get(`${API_BASE_URL}/api/RoomManagement/rooms/${roomId}`);
    
    console.log('åˆ›å»ºçš„æ•°æ®:', createResponse.data);
    console.log('è¯»å–çš„æ•°æ®:', getResponse.data);
    
    // éªŒè¯ä¸­æ–‡å­—ç¬¦æ˜¯å¦æ­£ç¡®
    if (getResponse.data.data.roomType === "è±ªåå¥—æˆ¿") {
        console.log('âœ… ä¸­æ–‡å­—ç¬¦å¤„ç†æ­£ç¡®');
    } else {
        console.log('âŒ ä¸­æ–‡å­—ç¬¦å¤„ç†æœ‰é—®é¢˜');
    }
}
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœä¸­æ–‡å­—ç¬¦ä»ç„¶æœ‰é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. å…·ä½“çš„è¯·æ±‚ä»£ç 
2. è¯·æ±‚å’Œå“åº”çš„å®Œæ•´æ•°æ®
3. æµè§ˆå™¨ç½‘ç»œé¢æ¿çš„æˆªå›¾
4. æ•°æ®åº“ä¸­å®é™…å­˜å‚¨çš„å†…å®¹

---
**é‡è¦æé†’**: ç¡®ä¿æ‰€æœ‰è¯·æ±‚éƒ½ä½¿ç”¨ `Content-Type: application/json; charset=utf-8` å¤´éƒ¨ï¼Œè¿™æ˜¯æ­£ç¡®å¤„ç†ä¸­æ–‡å­—ç¬¦çš„å…³é”®ï¼
